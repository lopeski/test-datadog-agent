FROM gcr.io/datadoghq/agent:7

ARG DD_APM_ENABLED=true
ARG DD_APM_NON_LOCAL_TRAFFIC=true
ARG DD_VERSION="0.0.1"
ARG DD_AGENT_HOST=dd-agent
ARG DD_LOGS_INJECTION=true 
ARG DD_TRACE_STARTUP_LOGS=true
ARG DD_APM_ENABLED=true 
ARG DD_APM_NON_LOCAL_TRAFFIC=true
ARG DD_LOGS_ENABLED=true
ARG DD_LOGS_CONFIG_CONTAINER_COLLECT_ALL=true
ARG DD_PROFILING_ENABLED=true

ENV DD_API_KEY=$DD_API_KEY
ENV DD_SITE=$DD_SITE
ENV DD_APM_ENABLED=$DD_APM_ENABLED
ENV DD_APM_NON_LOCAL_TRAFFIC=$DD_APM_NON_LOCAL_TRAFFIC
ENV DD_ENV=$DD_ENV
ENV DD_VERSION=$DD_VERSION
ENV DD_AGENT_HOST=$DD_AGENT_HOST
ENV DD_TRACE_AGENT_PORT=$DD_TRACE_AGENT_PORT
ENV DD_LOGS_INJECTION=$DD_LOGS_INJECTION
ENV DD_TRACE_STARTUP_LOGS=$DD_TRACE_STARTUP_LOGS
ENV DD_LOGS_ENABLED=$DD_LOGS_ENABLED
ENV DD_LOGS_CONFIG_CONTAINER_COLLECT_ALL=$DD_LOGS_CONFIG_CONTAINER_COLLECT_ALL
ENV DD_CONTAINER_EXCLUDE=$DD_CONTAINER_EXCLUDE
ENV DD_PROFILING_ENABLED=$DD_PROFILING_ENABLED

COPY ./configs/datadog.yaml /etc/datadog-agent/datadog.yaml